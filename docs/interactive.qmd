---
title: "Interactive Explorer"
format: html
jupyter: python3
---
```{python}
import pandas as pd
import plotly.express as px
import ipywidgets as widgets
from ipywidgets import interact

df = pd.read_csv("C:/Users/adans/OneDrive/Documents/Data Science/Project25/_Final Project - Boston Airbnb/~Final Project - Boston Airbnb/Data/LA_Airbnb_ALL.csv")

df['price_num'] = pd.to_numeric(
    df['price'].replace('[\$,]', '', regex=True),
    errors='coerce'
)
df = df[df['price_num'].notna() & (df['accommodates'] > 0)]
df['price_per_person'] = df['price_num'] / df['accommodates']

# Cleaning for review scores
df_reviews = df[df['review_scores_rating'].notna()].copy()
```
```{python}
### Widget 1
# Neighborhood Price Distiction 
neigh_options = ['All'] + sorted(df['neighbourhood_cleansed'].dropna().unique().tolist())

@interact(
neighbourhood=widgets.Dropdown(
options=neigh_options,
description='Neighborhood:',
style={'description_width': 'initial'}
),
max_price=widgets.IntSlider(
value=300,
min=50,
max=1000,
step=50,
description='Max Price ($):',
style={'description_width': 'initial'}
)
)
def neighborhood_price_widget(neighbourhood, max_price):
data = df[df['price_num'] <= max_price]


if neighbourhood != 'All':
    data = data[data['neighbourhood_cleansed'] == neighbourhood]

title = f"Price Distribution — {neighbourhood if neighbourhood != 'All' else 'All Neighborhoods'} (≤ ${max_price})"

fig = px.histogram(
    data,
    x='price_num',
    nbins=40,
    title=title,
    labels={'price_num': 'Nightly Price (USD)'}
)
fig.update_layout(height=500)
fig.show()
```

```{python}
### Widget 2
# Review Score vs Price 
@interact(
min_rating=widgets.IntSlider(
value=80,
min=0,
max=100,
step=5,
description='Minimum Rating:',
style={'description_width': 'initial'}
),
max_price=widgets.IntSlider(
value=400,
min=50,
max=1000,
step=50,
description='Max Price ($):',
style={'description_width': 'initial'}
)
)
def review_score_widget(min_rating, max_price):
data = df_reviews[
(df_reviews['review_scores_rating'] >= min_rating) &
(df_reviews['price_num'] <= max_price)
]

```
title = f"Price vs Review Score (Rating ≥ {min_rating}, Price ≤ ${max_price})"

fig = px.scatter(
    data,
    x='review_scores_rating',
    y='price_num',
    color='room_type',
    opacity=0.6,
    title=title,
    labels={
        'review_scores_rating': 'Review Score',
        'price_num': 'Nightly Price (USD)',
        'room_type': 'Room Type'
    }
)
fig.update_layout(height=500)
fig.show()
```

